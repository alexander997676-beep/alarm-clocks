<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberAlarm Pro</title>
    <!-- Add Web App Manifest for better APK support -->
    <link rel="manifest" href="manifest.json">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --neon-cyan: #00f3ff; --neon-pink: #ff0055; --bg-dark: #050505; }
        body { background-color: var(--bg-dark); color: white; font-family: sans-serif; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .app-shell { width: 100%; max-width: 400px; height: 95vh; background: #000; border-radius: 30px; position: relative; display: flex; flex-direction: column; padding: 20px; border: 1px solid #222; }
        .header { text-align: center; padding: 30px 0; }
        #current-time { font-size: 3.5rem; color: var(--neon-cyan); margin: 0; }
        .alarm-card { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .fab { position: absolute; bottom: 30px; right: 30px; width: 60px; height: 60px; background: var(--neon-cyan); border-radius: 50%; border: none; font-size: 1.5rem; cursor: pointer; }
        #alarm-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 999; flex-direction: column; justify-content: center; align-items: center; }
        .btn-stop { background: var(--neon-pink); color: white; padding: 15px 40px; border-radius: 30px; border: none; font-weight: bold; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="app-shell">
        <div class="header">
            <h1 id="current-time">00:00</h1>
            <p id="current-date">Loading...</p>
        </div>
        <div id="alarmList" style="flex:1; overflow-y:auto;"></div>
        <button class="fab" onclick="addAlarm()"><i class="fas fa-plus"></i></button>
    </div>

    <div id="alarm-modal">
        <h1 style="color: var(--neon-pink);">ALARM RINGING!</h1>
        <button class="btn-stop" onclick="stopAlarm()">STOP ALARM</button>
    </div>

    <!-- AUDIO FILE (Ensure alarm.mp3 is in the same folder on Vercel) -->
    <audio id="audio" loop>
        <source src="alarm.mp3" type="audio/mpeg">
    </audio>

    <script>
        let alarms = JSON.parse(localStorage.getItem('alarms')) || [];

        function updateTime() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('current-time').innerText = timeStr;
            document.getElementById('current-date').innerText = now.toDateString();

            alarms.forEach((alarm, index) => {
                if (alarm.enabled && alarm.time === timeStr && !alarm.triggered) {
                    triggerAlarm(index);
                }
                if (alarm.time !== timeStr) alarm.triggered = false;
            });
        }

        function addAlarm() {
            const t = prompt("Enter Time (HH:MM)", "07:00");
            if (t) {
                alarms.push({ time: t, enabled: true, triggered: false });
                render();
            }
        }

        function triggerAlarm(i) {
            alarms[i].triggered = true;
            document.getElementById('audio').play().catch(() => alert("Alarm Time! (Interact with screen to enable sound)"));
            document.getElementById('alarm-modal').style.display = 'flex';
            if (navigator.vibrate) navigator.vibrate([500, 200, 500]);
        }

        function stopAlarm() {
            document.getElementById('audio').pause();
            document.getElementById('alarm-modal').style.display = 'none';
        }

        function render() {
            localStorage.setItem('alarms', JSON.stringify(alarms));
            document.getElementById('alarmList').innerHTML = alarms.map((a, i) => `
                <div class="alarm-card">
                    <h2>${a.time}</h2>
                    <button onclick="alarms.splice(${i},1);render()" style="background:none; border:none; color:red;"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }

        setInterval(updateTime, 1000);
        render();
    </script>
</body>
</html>
